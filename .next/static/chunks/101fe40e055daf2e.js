(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,s,a)=>{s.exports=e.r(76562)},71923,e=>{"use strict";var s=e.i(43476),a=e.i(71645),t=e.i(18566),l=e.i(17927);function n({user:e}){return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Profile"}),e?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("span",{className:"font-medium",children:"Name:"})," ",e.name]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("span",{className:"font-medium",children:"Employee ID:"})," ",e.employee_id]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("span",{className:"font-medium",children:"Email:"})," ",e.email]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("span",{className:"font-medium",children:"Phone:"})," ",e.phone]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("span",{className:"font-medium",children:"Address:"})," ",e.address]})]}):(0,s.jsx)("p",{className:"text-gray-500",children:"Loading..."})]})}function i({userId:e}){let[t,n]=(0,a.useState)(!1),[i,r]=(0,a.useState)(null),[d,c]=(0,a.useState)(!1);async function o(){let s=new Date().toISOString().split("T")[0],{data:a}=await l.supabase.from("attendance").select("*").eq("user_id",e).eq("date",s).single();a&&(r(a),n(!!a.check_in))}async function m(){c(!0);let s=new Date().toISOString(),a=new Date().toISOString().split("T")[0];if(!i){let{error:t}=await l.supabase.from("attendance").insert({user_id:e,date:a,check_in:s,status:"present"});t||(n(!0),await o())}c(!1)}async function u(){c(!0);let e=new Date().toISOString();if(i){let{error:s}=await l.supabase.from("attendance").update({check_out:e}).eq("id",i.id);s||await o()}c(!1)}return(0,a.useEffect)(()=>{o()},[e]),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Attendance"}),(0,s.jsxs)("div",{className:"space-y-4",children:[i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("span",{className:"font-medium",children:"Check In:"})," ",i.check_in?new Date(i.check_in).toLocaleTimeString():"Not checked in"]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("span",{className:"font-medium",children:"Check Out:"})," ",i.check_out?new Date(i.check_out).toLocaleTimeString():"Not checked out"]}),(0,s.jsxs)("p",{className:"text-gray-700",children:[(0,s.jsx)("span",{className:"font-medium",children:"Status:"})," ",(0,s.jsx)("span",{className:"capitalize",children:i.status})]})]}),(0,s.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,s.jsx)("button",{onClick:m,disabled:t||d,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition disabled:bg-gray-400",children:"Check In"}),(0,s.jsx)("button",{onClick:u,disabled:!t||!!i?.check_out||d,className:"flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition disabled:bg-gray-400",children:"Check Out"})]})]})]})}function r({userId:e,leaveRequests:t,onRefresh:n}){let[i,r]=(0,a.useState)(!1),[d,c]=(0,a.useState)(!1),[o,m]=(0,a.useState)({fromDate:"",toDate:"",type:"paid",remarks:""});function u(e){let{name:s,value:a}=e.target;m(e=>({...e,[s]:a}))}async function x(s){s.preventDefault(),c(!0);let{error:a}=await l.supabase.from("leave_requests").insert({user_id:e,from_date:o.fromDate,to_date:o.toDate,type:o.type,remarks:o.remarks,status:"pending"});a||(m({fromDate:"",toDate:"",type:"paid",remarks:""}),r(!1),await n()),c(!1)}return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Leave Requests"}),t.length>0?(0,s.jsx)("div",{className:"space-y-3 mb-4",children:t.slice(0,3).map(e=>(0,s.jsxs)("div",{className:"p-3 bg-gray-50 rounded",children:[(0,s.jsxs)("p",{className:"text-sm font-medium",children:[new Date(e.from_date).toLocaleDateString()," -"," ",new Date(e.to_date).toLocaleDateString()]}),(0,s.jsxs)("p",{className:"text-xs text-gray-600 capitalize",children:[e.type," Â· ",e.status]})]},e.id))}):(0,s.jsx)("p",{className:"text-gray-500 text-sm mb-4",children:"No leave requests yet"}),i?(0,s.jsxs)("form",{onSubmit:x,className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Date"}),(0,s.jsx)("input",{type:"date",name:"fromDate",value:o.fromDate,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Date"}),(0,s.jsx)("input",{type:"date",name:"toDate",value:o.toDate,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),(0,s.jsxs)("select",{name:"type",value:o.type,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[(0,s.jsx)("option",{value:"paid",children:"Paid Leave"}),(0,s.jsx)("option",{value:"sick",children:"Sick Leave"}),(0,s.jsx)("option",{value:"unpaid",children:"Unpaid Leave"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remarks"}),(0,s.jsx)("textarea",{name:"remarks",value:o.remarks,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",rows:2})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{type:"submit",disabled:d,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition disabled:bg-gray-400",children:"Submit"}),(0,s.jsx)("button",{type:"button",onClick:()=>r(!1),className:"flex-1 bg-gray-300 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-400 transition",children:"Cancel"})]})]}):(0,s.jsx)("button",{onClick:()=>r(!0),className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:"Request Leave"})]})}function d(){let e=(0,t.useRouter)(),[d,c]=(0,a.useState)(null),[o,m]=(0,a.useState)([]),[u,x]=(0,a.useState)(!0);async function h(e){let{data:s}=await l.supabase.from("leave_requests").select("*").eq("user_id",e).order("created_at",{ascending:!1});m(s||[])}async function p(){await l.supabase.auth.signOut(),e.push("/")}return((0,a.useEffect)(()=>{(async()=>{let{data:{user:s}}=await l.supabase.auth.getUser();if(!s)return e.push("/auth/login");let{data:a}=await l.supabase.from("users").select("*").eq("id",s.id).single();a?.role!=="employee"?e.push("/dashboard/hr"):(c(a),await h(s.id),x(!1))})()},[e]),u)?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("p",{className:"text-lg text-gray-600",children:"Loading..."})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("div",{className:"bg-white shadow",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 flex justify-between items-center",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Employee Dashboard"}),(0,s.jsx)("button",{onClick:p,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition",children:"Logout"})]})}),(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,s.jsx)(n,{user:d}),(0,s.jsx)(i,{userId:d?.id||""}),(0,s.jsx)(r,{userId:d?.id||"",leaveRequests:o,onRefresh:()=>h(d?.id||"")})]})})]})}e.s(["default",()=>d],71923)}]);