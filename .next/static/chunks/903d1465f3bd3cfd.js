(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,s,t)=>{s.exports=e.r(76562)},79065,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(18566),l=e.i(17927);function i({onSelectEmployee:e,selectedId:a}){let[i,r]=(0,t.useState)([]),[n,d]=(0,t.useState)(!0);async function c(){let{data:e}=await l.supabase.from("users").select("*").eq("role","employee");r(e||[]),d(!1)}return((0,t.useEffect)(()=>{c()},[]),n)?(0,s.jsx)("p",{className:"text-gray-500",children:"Loading employees..."}):(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,s.jsx)("div",{className:"p-4 border-b",children:(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Employees"})}),(0,s.jsx)("div",{className:"divide-y max-h-96 overflow-y-auto",children:i.map(t=>(0,s.jsxs)("button",{onClick:()=>e(t),className:`w-full text-left p-4 hover:bg-gray-50 transition ${a===t.id?"bg-blue-50 border-l-4 border-blue-600":""}`,children:[(0,s.jsx)("p",{className:"font-medium text-gray-900",children:t.name}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:t.employee_id})]},t.id))})]})}function r({employeeId:e}){let[a,i]=(0,t.useState)([]),[r,n]=(0,t.useState)(!0);async function d(){n(!0);let{data:s}=await l.supabase.from("attendance").select("*").eq("user_id",e).order("date",{ascending:!1}).limit(10);i(s||[]),n(!1)}return((0,t.useEffect)(()=>{d()},[e]),r)?(0,s.jsx)("p",{className:"text-gray-500",children:"Loading..."}):(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,s.jsx)("div",{className:"p-4 border-b",children:(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Recent Attendance"})}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-900",children:"Date"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-900",children:"Check In"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-900",children:"Check Out"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-900",children:"Status"})]})}),(0,s.jsx)("tbody",{children:a.map(e=>(0,s.jsxs)("tr",{className:"border-t hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900",children:new Date(e.date).toLocaleDateString()}),(0,s.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900",children:e.check_in?new Date(e.check_in).toLocaleTimeString():"-"}),(0,s.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900",children:e.check_out?new Date(e.check_out).toLocaleTimeString():"-"}),(0,s.jsx)("td",{className:"px-4 py-2 text-sm",children:(0,s.jsx)("span",{className:"px-2 py-1 bg-gray-200 text-gray-800 rounded capitalize text-xs font-medium",children:e.status})})]},e.id))})]})})]})}function n(){let[e,a]=(0,t.useState)([]),[i,r]=(0,t.useState)(!0);async function n(){let{data:e}=await l.supabase.from("leave_requests").select("*, users(name, employee_id)").eq("status","pending").order("created_at",{ascending:!1});a(e||[]),r(!1)}async function d(e){let{error:s}=await l.supabase.from("leave_requests").update({status:"approved"}).eq("id",e);s||await n()}async function c(e){let{error:s}=await l.supabase.from("leave_requests").update({status:"rejected"}).eq("id",e);s||await n()}return((0,t.useEffect)(()=>{n()},[]),i)?(0,s.jsx)("p",{className:"text-gray-500",children:"Loading..."}):(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,s.jsx)("div",{className:"p-4 border-b",children:(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Leave Approvals"})}),(0,s.jsx)("div",{className:"divide-y",children:e.length>0?e.map(e=>(0,s.jsxs)("div",{className:"p-4 hover:bg-gray-50",children:[(0,s.jsxs)("p",{className:"font-medium text-gray-900",children:[e.users?.name," (",e.users?.employee_id,")"]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[new Date(e.from_date).toLocaleDateString()," -"," ",new Date(e.to_date).toLocaleDateString()]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,s.jsx)("span",{className:"capitalize font-medium",children:e.type})," Leave"]}),e.remarks&&(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Remarks: ",e.remarks]}),(0,s.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,s.jsx)("button",{onClick:()=>d(e.id),className:"flex-1 bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition",children:"Approve"}),(0,s.jsx)("button",{onClick:()=>c(e.id),className:"flex-1 bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition",children:"Reject"})]})]},e.id)):(0,s.jsx)("p",{className:"p-4 text-gray-500 text-sm",children:"No pending leave requests"})})]})}function d({employeeId:e}){let[a,i]=(0,t.useState)(null),[r,n]=(0,t.useState)(!0);async function d(){let{data:s}=await l.supabase.from("users").select("*").eq("id",e).single();i(s),n(!1)}if((0,t.useEffect)(()=>{d()},[e]),r)return(0,s.jsx)("p",{className:"text-gray-500",children:"Loading..."});if(!a)return(0,s.jsx)("p",{className:"text-gray-500",children:"Employee not found"});let c=a.salary,x=.08*c;return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Payroll Details"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between py-2 border-b",children:[(0,s.jsx)("span",{className:"text-gray-700",children:"Basic Salary"}),(0,s.jsxs)("span",{className:"font-medium",children:["₹",(.6*c).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex justify-between py-2 border-b",children:[(0,s.jsx)("span",{className:"text-gray-700",children:"HRA"}),(0,s.jsxs)("span",{className:"font-medium",children:["₹",(.2*c).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex justify-between py-2 border-b",children:[(0,s.jsx)("span",{className:"text-gray-700",children:"Dearness Allowance"}),(0,s.jsxs)("span",{className:"font-medium",children:["₹",(.1*c).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex justify-between py-2 border-b border-red-300",children:[(0,s.jsx)("span",{className:"text-gray-700",children:"Deductions"}),(0,s.jsxs)("span",{className:"font-medium text-red-600",children:["-₹",x.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex justify-between py-3 bg-blue-50 px-3 rounded",children:[(0,s.jsx)("span",{className:"font-semibold text-gray-900",children:"Net Salary"}),(0,s.jsxs)("span",{className:"font-bold text-blue-600 text-lg",children:["₹",(c-x).toFixed(2)]})]})]})]})}function c(){let e=(0,a.useRouter)(),[c,x]=(0,t.useState)(null),[o,m]=(0,t.useState)(!0);async function h(){await l.supabase.auth.signOut(),e.push("/")}return((0,t.useEffect)(()=>{(async()=>{let{data:{user:s}}=await l.supabase.auth.getUser();if(!s)return e.push("/auth/login");let{data:t}=await l.supabase.from("users").select("*").eq("id",s.id).single();t?.role!=="hr"?e.push("/dashboard/employee"):m(!1)})()},[e]),o)?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("p",{className:"text-lg text-gray-600",children:"Loading..."})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("div",{className:"bg-white shadow",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 flex justify-between items-center",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"HR Dashboard"}),(0,s.jsx)("button",{onClick:h,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition",children:"Logout"})]})}),(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsx)(i,{onSelectEmployee:x,selectedId:c?.id})}),(0,s.jsxs)("div",{className:"lg:col-span-3 space-y-6",children:[c?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r,{employeeId:c.id}),(0,s.jsx)(d,{employeeId:c.id})]}):(0,s.jsx)("div",{className:"bg-white rounded-lg shadow p-8 text-center text-gray-500",children:"Select an employee to view details"}),(0,s.jsx)(n,{})]})]})})]})}e.s(["default",()=>c],79065)}]);